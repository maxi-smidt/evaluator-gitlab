<p-toast></p-toast>

<h2>{{ 'degree-program.courses-view.courses' | translate }}</h2>

<p-accordion class="w-full" expandIcon="pi pi-plus" collapseIcon="pi pi-minus">
  @for (course of detailCourses; track course.name) {
    <p-accordionTab>
      <ng-template pTemplate="header">
        <div class="d-flex align-items-center w-100">
          <span class="font-bold white-space-nowrap">
            [{{ course.abbreviation }}] {{ course.name }}
          </span>
          <div class="ms-auto me-3">
            <p-badge value="{{ course.assignments.length }}" class="me-2"/>
          </div>
          <p-button icon="pi pi-plus" severity="success" (onClick)="onNewInstanceClick($event, course.id)" size="small"
                    label="{{ 'degree-program.courses-view.course-list.new-instance' | translate }}"/>
        </div>
      </ng-template>

      <p-dataView [value]="course.assignments">
        <ng-template pTemplate="list">
          <div class="grid">
            @for (assignment of course.assignments; track assignment.id) {
              <div class="col-12">
                <div class="d-flex flex-row p-1 gap-3 border border-1 rounded-1 align-items-center">
                  <h5 class="ms-1 mb-0">{{ assignment.name }}</h5>
                  <div class="ms-auto">
                    <p-button icon="pi pi-arrow-right" size="small"/>
                  </div>
                </div>
              </div>
            }
          </div>
        </ng-template>
      </p-dataView>
    </p-accordionTab>
  }
</p-accordion>

<p-dialog header="{{ 'degree-program.courses-view.course-list.new-instance' | translate }}" [modal]="true"
          [(visible)]="dialogVisible">
  <span class="p-text-secondary block mb-5">{{ 'degree-program.courses-view.course-list.new-instance-info' | translate }}</span>
  <div class="flex align-items-center gap-3 mt-3 mb-3">
    <label for="year" class="font-semibold w-6rem">{{ 'degree-program.courses-view.course-list.year' | translate }}</label>
    <p-inputOtp id="year" [(ngModel)]="year"/>
  </div>
  <div class="flex gap-2">
    <p-button label="{{ 'common.cancel' | translate }}" severity="secondary" (onClick)="dialogVisible = false"/>
    <p-button class="ms-2" label="{{ 'common.btn-save' | translate }}" (onClick)="onSaveNewInstanceClick()"/>
  </div>
</p-dialog>
